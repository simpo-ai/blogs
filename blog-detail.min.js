let blogDetails;
class blogDetail{
    constructor(){
        blogDetails = JSON.parse(window.localStorage.getItem('blogDetail'));
        getBlogDetails(blogDetails)
    }
}

function getBlogDetails(singleBlogDetails){
    var detailContainer = document.getElementById('blog-details');

    var blogTitle = document.createElement("div");
    blogTitle.className = "blog-title";
    blogTitle.innerHTML += singleBlogDetails.postTitle
    detailContainer.appendChild(blogTitle);

    //author related details
    var authorRelated = document.createElement("div");
    authorRelated.className = "author-related";
    detailContainer.appendChild(authorRelated);

    var extension = document.createElement("div");
    extension.className = "extension";
    authorRelated.appendChild(extension);

    if(singleBlogDetails.author != null){
        var circle = document.createElement("div");
        circle.className = "dot-color";
        extension.appendChild(circle);
    }

    var authorName = document.createElement("div");
    authorName.className = "author-name";
    if(singleBlogDetails.author != null || singleBlogDetails.author.content != ""){
        authorName.innerHTML += titleCase(singleBlogDetails?.author?.content);
    }
    extension.appendChild(authorName);

    //date and read time related
    var extension = document.createElement("div");
    extension.className = "extension";
    authorRelated.appendChild(extension);


    var circle = document.createElement("div");
    circle.className = "dot-color";
    extension.appendChild(circle);

    var date = document.createElement("div");
    date.className = "date-readTime";
    date.innerHTML += new Date(singleBlogDetails.createdTimeStamp).toDateString()
    extension.appendChild(date);

    var separator = document.createElement("div");
    separator.className = "separator";
    separator.innerHTML += "|";
    extension.appendChild(separator);

    var readTime = document.createElement("div");
    readTime.className = "readTime";
    if(singleBlogDetails.readTime === "NaN" || singleBlogDetails.readTime === null){
        singleBlogDetails.readTime = 0
    }
    readTime.innerHTML += singleBlogDetails.readTime + " Min read";
    extension.appendChild(readTime)

    for (var i = 0; i < singleBlogDetails.blocks.length; i++) {
        var blockDetail = singleBlogDetails.blocks[i];
        var blockBox = document.createElement("div");
        
        //header tag like h1,h2,h3...etc
        var hTags;
        if(blockDetail.type === 'header'){
            if(blockDetail.data.level === 1){
                hTags = document.createElement("h1");
            }
            if(blockDetail.data.level === 2){
                hTags = document.createElement("h2");
            }
            if(blockDetail.data.level === 3){
                hTags = document.createElement("h2");
            }
            if(blockDetail.data.level === 4){
                hTags = document.createElement("h2");
            }
            if(blockDetail.data.level === 5){
                hTags = document.createElement("h2");
            }
            if(blockDetail.data.level === 6){
                hTags = document.createElement("h2");
            }
            hTags.innerHTML += blockDetail.data.text;
            blockBox.appendChild(hTags);
        }

        // blog type like paragraph
        if(blockDetail.type === 'paragraph'){
            var paragraph = document.createElement("p");
            paragraph.innerHTML += blockDetail.data.text;
            blockBox.appendChild(paragraph);
        }

        // blog type like image
        if(blockDetail.type === 'image'){
            var imageDiv = document.createElement("div");
            imageDiv.className = "blog-image"
            var imageSource = document.createElement("img");
            imageSource.src = blockDetail.data.file.url;
            blockBox.appendChild(imageDiv);
            imageDiv.appendChild(imageSource);
        }

        //blog type like ordered list
        if(blockDetail.type === 'list'){
            var ol = document.createElement("ul");
            blockBox.appendChild(ol);
            var li;
            for (let j = 0; j < blockDetail.data.items.length; j++) {
                let liDetail = blockDetail.data.items[j];
                li = document.createElement("li");
                li.innerHTML += liDetail;
                ol.appendChild(li)
            }
        }



        // section type like table
        if(blockDetail.type === 'table'){
            var table = document.createElement('table');
            var tr;
            var td;
            blockBox.appendChild(table);
            for (let k = 0; k < blockDetail.data.content.length; k++) {
                let tableDetail = blockDetail.data.content[k];
                tr = document.createElement("tr");
                table.appendChild(tr);
                for (let l = 0; l < tableDetail.length; l++) {                    
                    let tdDetail = tableDetail[l];
                    td = document.createElement("td");
                    td.innerHTML += tdDetail;
                    tr.appendChild(td);
                }
            }
        }

        if(blockDetail.type === 'delimiter'){
            var div = document.createElement('div');
            div.className = "delimter-section";
            var delimiter = document.createElement("div");
            delimiter.className = "ce-delimiter";
            blockBox.appendChild(div);
            div.appendChild(delimiter);
        }

        detailContainer.appendChild(blockBox);
    }
}
function titleCase(str) {
    if(str === null || str === undefined || str === ""){
     return str.toLowerCase().split(' ').map(function(word) {
      return word.replace(word[0], word[0].toUpperCase());
    }).join(' ');   
    }
    else{
        return "N/A"
    }
}

var singleBlog = new blogDetail();
